(self.webpackChunkbudget_app=self.webpackChunkbudget_app||[]).push([[357],{6357:(t,e,s)=>{"use strict";s.r(e),s.d(e,{CustomersModule:()=>E});var o=s(1116),r=s(1462),n=s(4140),i=s(8619),a=s(2232),c=s(6222),u=s(1518);const l=["a","b","c","d"];function m(t){let e=!1;return l.forEach(s=>{t.value.toLowerCase().startsWith(s)&&(e=!0)}),e?9!==t.value.length?{invalidCif:!0,mensaje:"El CIF debe tener 9 caracteres"}:null:{invalidCif:!0,mensaje:"El CIF debe comenzar por A, B, C \xf3 D"}}var p=s(6457);function d(t,e){1&t&&(i.TgZ(0,"span",19),i._uU(1," Nombre de cliente obligatorio "),i.qZA())}function g(t,e){if(1&t&&(i.TgZ(0,"span",19),i._uU(1),i.qZA()),2&t){const t=i.oxw();i.xp6(1),i.hij(" ",null==t.form.controls||null==t.form.controls.cif||null==t.form.controls.cif.errors?null:t.form.controls.cif.errors.mensaje," ")}}function Z(t,e){1&t&&(i.TgZ(0,"span",19),i._uU(1," Direcci\xf3n de cliente obligatoria "),i.qZA())}function f(t,e){1&t&&(i.TgZ(0,"span",19),i._uU(1," Localidad de cliente obligatoria "),i.qZA())}function h(t,e){1&t&&(i.TgZ(0,"span",19),i._uU(1," Nombre de contacto obligatorio "),i.qZA())}function v(t,e){1&t&&(i.TgZ(0,"span",19),i._uU(1," Nombre de contacto obligatorio "),i.qZA())}function q(t,e){1&t&&(i.TgZ(0,"span",19),i._uU(1," Correo electr\xf3nico de contacto obligatorio "),i.qZA())}function b(t,e){1&t&&(i.TgZ(0,"span",19),i._uU(1," El correo electr\xf3nico no es correcto "),i.qZA())}function T(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"button",20),i.NdJ("click",function(){return i.CHM(t),i.oxw().setValidation()}),i._uU(1,"Enviar"),i.qZA()}}const A=function(){return{showLoading:!0,display:"inline"}},_=function(){return{showLoading:!1,display:"inline"}};function w(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"button",20),i.NdJ("click",function(){return i.CHM(t),i.oxw().submitCustomer()}),i.TgZ(1,"span",21),i._uU(2,"Espere..."),i.qZA(),i.TgZ(3,"span",21),i._uU(4,"Enviar"),i.qZA(),i.qZA()}2&t&&(i.xp6(1),i.Q6J("appLoading",i.DdM(2,A)),i.xp6(2),i.Q6J("appLoading",i.DdM(3,_)))}let U=(()=>{class t{constructor(){this.customerEmitter=new i.vpe,this.showValidation=!1}ngOnInit(){this.form=new r.cw({name:new r.NI("",[r.kI.required]),cif:new r.NI("",[m]),adress:new r.NI("",[r.kI.required]),cp:new r.NI(""),city:new r.NI("",[r.kI.required]),contact:new r.cw({name:new r.NI("",[r.kI.required]),surname:new r.NI("",[r.kI.required]),phone:new r.NI(""),email:new r.NI("",[r.kI.required,r.kI.pattern(/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$/)])})}),this.form.patchValue(this.customer)}setValidation(){this.showValidation=!0}submitCustomer(){this.customerEmitter.emit(this.form.value)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-customer-form"]],inputs:{customer:"customer"},outputs:{customerEmitter:"customerEmitter"},decls:61,vars:12,consts:[[3,"formGroup"],[1,"form-title"],[1,"row"],[1,"col-100"],["class","alert",4,"ngIf"],["type","text","formControlName","name"],["type","text","formControlName","cif","maxlength","9",3,"readonly"],["type","text","formControlName","adress"],[1,"col-50","p-r"],["type","text","formControlName","cp"],[1,"col-50","p-l"],["type","text","formControlName","city"],["formGroupName","contact"],["type","text","formControlName","surname"],["type","text","formControlName","phone"],["type","text","formControlName","email"],[1,"flex","j-end","a-center","m-t"],["type","button","routerLink","/customers",1,"outline","m-r-small"],["type","button",3,"click",4,"ngIf"],[1,"alert"],["type","button",3,"click"],[3,"appLoading"]],template:function(t,e){1&t&&(i.TgZ(0,"form",0),i.TgZ(1,"p",1),i._uU(2,"Cliente"),i.qZA(),i.TgZ(3,"div",2),i.TgZ(4,"div",3),i.TgZ(5,"label"),i._uU(6," Nombre "),i.YNc(7,d,2,0,"span",4),i.qZA(),i._UZ(8,"input",5),i.qZA(),i.qZA(),i.TgZ(9,"div",2),i.TgZ(10,"div",3),i.TgZ(11,"label"),i._uU(12," CIF "),i.YNc(13,g,2,1,"span",4),i.qZA(),i._UZ(14,"input",6),i.qZA(),i.qZA(),i.TgZ(15,"div",2),i.TgZ(16,"div",3),i.TgZ(17,"label"),i._uU(18," Direcci\xf3n "),i.YNc(19,Z,2,0,"span",4),i.qZA(),i._UZ(20,"input",7),i.qZA(),i.qZA(),i.TgZ(21,"div",2),i.TgZ(22,"div",8),i.TgZ(23,"label"),i._uU(24,"C\xf3digo Postal"),i.qZA(),i._UZ(25,"input",9),i.qZA(),i.TgZ(26,"div",10),i.TgZ(27,"label"),i._uU(28," Localidad "),i.YNc(29,f,2,0,"span",4),i.qZA(),i._UZ(30,"input",11),i.qZA(),i.qZA(),i.TgZ(31,"p",1),i._uU(32,"Contacto"),i.qZA(),i.TgZ(33,"div",12),i.TgZ(34,"div",2),i.TgZ(35,"div",8),i.TgZ(36,"label"),i._uU(37," Nombre "),i.YNc(38,h,2,0,"span",4),i.qZA(),i._UZ(39,"input",5),i.qZA(),i.TgZ(40,"div",10),i.TgZ(41,"label"),i._uU(42," Apellidos "),i.YNc(43,v,2,0,"span",4),i.qZA(),i._UZ(44,"input",13),i.qZA(),i.qZA(),i.TgZ(45,"div",2),i.TgZ(46,"div",8),i.TgZ(47,"label"),i._uU(48,"Tel\xe9fono"),i.qZA(),i._UZ(49,"input",14),i.qZA(),i.TgZ(50,"div",10),i.TgZ(51,"label"),i._uU(52," Correo electr\xf3nico "),i.YNc(53,q,2,0,"span",4),i.YNc(54,b,2,0,"span",4),i.qZA(),i._UZ(55,"input",15),i.qZA(),i.qZA(),i.qZA(),i.TgZ(56,"div",16),i.TgZ(57,"button",17),i._uU(58,"Cancelar"),i.qZA(),i.YNc(59,T,2,0,"button",18),i.YNc(60,w,5,4,"button",18),i.qZA(),i.qZA()),2&t&&(i.Q6J("formGroup",e.form),i.xp6(7),i.Q6J("ngIf",(null==e.form.controls||null==e.form.controls.name||null==e.form.controls.name.errors?null:e.form.controls.name.errors.required)&&e.showValidation),i.xp6(6),i.Q6J("ngIf",(null==e.form.controls||null==e.form.controls.cif||null==e.form.controls.cif.errors?null:e.form.controls.cif.errors.invalidCif)&&e.showValidation),i.xp6(1),i.Q6J("readonly",void 0!==e.customer),i.xp6(5),i.Q6J("ngIf",(null==e.form.controls||null==e.form.controls.adress||null==e.form.controls.adress.errors?null:e.form.controls.adress.errors.required)&&e.showValidation),i.xp6(10),i.Q6J("ngIf",(null==e.form.controls||null==e.form.controls.city||null==e.form.controls.city.errors?null:e.form.controls.city.errors.required)&&e.showValidation),i.xp6(9),i.Q6J("ngIf",(null==e.form.get("contact.name").errors?null:e.form.get("contact.name").errors.required)&&e.showValidation),i.xp6(5),i.Q6J("ngIf",(null==e.form.get("contact.surname").errors?null:e.form.get("contact.surname").errors.required)&&e.showValidation),i.xp6(10),i.Q6J("ngIf",(null==e.form.get("contact.email").errors?null:e.form.get("contact.email").errors.required)&&e.showValidation),i.xp6(1),i.Q6J("ngIf",(null==e.form.get("contact.email").errors?null:e.form.get("contact.email").errors.pattern)&&e.showValidation),i.xp6(5),i.Q6J("ngIf",e.form.invalid),i.xp6(1),i.Q6J("ngIf",e.form.valid))},directives:[r._Y,r.JL,r.sg,o.O5,r.Fj,r.JJ,r.u,r.nD,r.x0,n.rH,p.T],styles:[""]}),t})(),C=(()=>{class t{constructor(t,e,s,o){this.route=t,this.router=e,this.toastMessagesService=s,this.customersService=o}ngOnInit(){this.dataRoutes=this.route.pathFromRoot}submitCustomer(t){this.customersService.postCustomer(t).subscribe(t=>{this.toastMessagesService.setToastMessage("success",t.message),this.router.navigate(["/customers"])},t=>{var e;(null===(e=t.error)||void 0===e?void 0:e.message)?this.toastMessagesService.setToastMessage("danger",t.error.message):this.toastMessagesService.setToastMessage("warning","El servidor no se encuentra disponible en estos momentos")})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(n.gz),i.Y36(n.F0),i.Y36(a.e),i.Y36(c.v))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-create-customer"]],decls:4,vars:1,consts:[[1,"container","show"],[3,"dataRoutes"],[1,"card"],[3,"customerEmitter"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i._UZ(1,"app-breadcrumbs",1),i.TgZ(2,"div",2),i.TgZ(3,"app-customer-form",3),i.NdJ("customerEmitter",function(t){return e.submitCustomer(t)}),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(1),i.Q6J("dataRoutes",e.dataRoutes))},directives:[u.n,U],styles:[""]}),t})();const N=function(){return{showLoading:!1,display:"table-row"}};function x(t,e){if(1&t&&(i.TgZ(0,"tr",14),i.TgZ(1,"td"),i._uU(2),i.qZA(),i.TgZ(3,"td"),i._uU(4),i.qZA(),i.TgZ(5,"td"),i._uU(6),i.qZA(),i.TgZ(7,"td"),i._UZ(8,"img",15),i.qZA(),i.qZA()),2&t){const t=e.$implicit;i.Q6J("appLoading",i.DdM(5,N)),i.xp6(2),i.Oqu(t.name),i.xp6(2),i.Oqu(t.cif),i.xp6(2),i.Oqu(t.city),i.xp6(2),i.MGl("routerLink","update-customer/",t._id,"")}}function k(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"button",16),i.NdJ("click",function(){return i.CHM(t),i.oxw().changePage(-1)}),i._uU(1,"Ant"),i.qZA()}}function I(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"button",17),i.NdJ("click",function(){return i.CHM(t),i.oxw().changePage(1)}),i._uU(1,"Sig"),i.qZA()}}const J=function(){return{showLoading:!0,display:"block"}};function M(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"app-customer-form",4),i.NdJ("customerEmitter",function(e){return i.CHM(t),i.oxw().submitCustomer(e)}),i.qZA()}if(2&t){const t=i.oxw();i.Q6J("customer",t.customer)}}const y=[{path:"",component:(()=>{class t{constructor(t,e,s){this.route=t,this.toastMessagesService=e,this.customersService=s}ngOnInit(){this.dataRoutes=this.route.pathFromRoot,this.customersService.getPagesState().subscribe(t=>{this.skip=t.skip,this.limit=t.limit}),this.loadCustomers()}loadCustomers(){this.customersService.getCustomers(this.skip,this.limit).subscribe(t=>{this.totalCustomers=t.totalCustomers,this.customers=t.customers},t=>{var e;(null===(e=t.error)||void 0===e?void 0:e.message)?this.toastMessagesService.setToastMessage("danger",t.error.message):this.toastMessagesService.setToastMessage("warning","El servidor no se encuentra disponible en estos momentos")})}changePage(t){this.skip=this.skip+this.limit*t,this.customersService.setPagesState(this.skip,this.limit),this.loadCustomers()}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(n.gz),i.Y36(a.e),i.Y36(c.v))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-customers-report"]],decls:24,vars:6,consts:[[1,"container","show"],[3,"dataRoutes"],["routerLink","create-customer",1,"outline"],[1,"card"],[3,"appLoading",4,"ngFor","ngForOf"],[1,"spinner",3,"appLoading"],[1,"sk-folding-cube"],[1,"sk-cube1","sk-cube"],[1,"sk-cube2","sk-cube"],[1,"sk-cube4","sk-cube"],[1,"sk-cube3","sk-cube"],[1,"flex","j-end","a-center"],[3,"click",4,"ngIf"],["class","m-l-small",3,"click",4,"ngIf"],[3,"appLoading"],["src","/assets/img/icons/edit.svg",3,"routerLink"],[3,"click"],[1,"m-l-small",3,"click"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"app-breadcrumbs",1),i.TgZ(2,"button",2),i._uU(3,"Nuevo Cliente"),i.qZA(),i.qZA(),i.TgZ(4,"div",3),i.TgZ(5,"table"),i.TgZ(6,"tr"),i.TgZ(7,"th"),i._uU(8,"Nombre"),i.qZA(),i.TgZ(9,"th"),i._uU(10,"CIF"),i.qZA(),i.TgZ(11,"th"),i._uU(12,"Localidad"),i.qZA(),i._UZ(13,"th"),i.qZA(),i.YNc(14,x,9,6,"tr",4),i.qZA(),i.TgZ(15,"div",5),i.TgZ(16,"div",6),i._UZ(17,"div",7),i._UZ(18,"div",8),i._UZ(19,"div",9),i._UZ(20,"div",10),i.qZA(),i.qZA(),i.TgZ(21,"div",11),i.YNc(22,k,2,0,"button",12),i.YNc(23,I,2,0,"button",13),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(1),i.Q6J("dataRoutes",e.dataRoutes),i.xp6(13),i.Q6J("ngForOf",e.customers),i.xp6(1),i.Q6J("appLoading",i.DdM(5,J)),i.xp6(7),i.Q6J("ngIf",e.skip>0),i.xp6(1),i.Q6J("ngIf",e.skip<e.totalCustomers-e.limit))},directives:[u.n,n.rH,o.sg,p.T,o.O5],styles:[""]}),t})()},{path:"create-customer",component:C,data:{title:"Nuevo cliente",absolutePath:"/customers/create-customer"}},{path:"update-customer/:_id",component:(()=>{class t{constructor(t,e,s,o){this.route=t,this.router=e,this.toastMessagesService=s,this.customersService=o}ngOnInit(){this.dataRoutes=this.route.pathFromRoot,this._id=this.route.snapshot.params._id,this.customersService.getCustomer(this._id).subscribe(t=>{this.customer=t.customer},t=>{var e;(null===(e=t.error)||void 0===e?void 0:e.message)?this.toastMessagesService.setToastMessage("danger",t.error.message):this.toastMessagesService.setToastMessage("warning","El servidor no se encuentra disponible en estos momentos")})}submitCustomer(t){this.customersService.putCustomer(this._id,t).subscribe(t=>{this.toastMessagesService.setToastMessage("success",t.message),this.router.navigate(["/customers"])},t=>{var e;(null===(e=t.error)||void 0===e?void 0:e.message)?this.toastMessagesService.setToastMessage("danger",t.error.message):this.toastMessagesService.setToastMessage("warning","El servidor no se encuentra disponible en estos momentos")})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(n.gz),i.Y36(n.F0),i.Y36(a.e),i.Y36(c.v))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-update-customer"]],decls:4,vars:2,consts:[[1,"container","show"],[3,"dataRoutes"],[1,"card"],[3,"customer","customerEmitter",4,"ngIf"],[3,"customer","customerEmitter"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i._UZ(1,"app-breadcrumbs",1),i.TgZ(2,"div",2),i.YNc(3,M,1,1,"app-customer-form",3),i.qZA(),i.qZA()),2&t&&(i.xp6(1),i.Q6J("dataRoutes",e.dataRoutes),i.xp6(2),i.Q6J("ngIf",e.customer))},directives:[u.n,o.O5,U],styles:[""]}),t})(),data:{title:"Modificar cliente",absolutePath:"/customers/update-customer"}}];let S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[n.Bz.forChild(y)],n.Bz]}),t})();var Y=s(5425);let E=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[o.ez,S,Y.m,r.UX]]}),t})()}}]);